<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    
    <title>My Vault</title>
    
    <!-- Ø£Ø¶Ù Ù‡Ø°Ø§ Ø§Ù„Ø³Ø·Ø± -->
    <link rel="stylesheet" href="index.css?v=3">
    
    <!-- Ø¥Ø°Ø§ ÙƒØ§Ù† Ø¹Ù†Ø¯Ùƒ Ø³ØªØ§ÙŠÙ„Ø§Øª Ø£Ø®Ø±Ù‰ -->
    <style>
        /* Ø£ÙŠ Ø³ØªØ§ÙŠÙ„Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© */
    </style>
    <script>
// Ø§Ø®ØªØµØ§Ø± Ù„ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ­Ø¯ÙŠØ« ÙŠØ¯ÙˆÙŠØ§Ù‹ (Ø£Ø¶ÙÙ‡ ÙÙŠ console Ø£Ùˆ ÙÙŠ Ø§Ù„ÙƒÙˆØ¯)
function forceUpdateCheck() {
    const updater = new AutoUpdater();
    updater.checkForUpdates();
}

// Ø§Ø®ØªØµØ§Ø± Ø¢Ø®Ø± - Ø§Ø¶ØºØ· F12 ÙÙŠ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ÙˆØ§ÙƒØªØ¨:
// forceUpdateCheck()
</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Vault - ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</title>
    <link rel="icon" type="image/x-icon" href="icon.ico">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 400px;
            backdrop-filter: blur(10px);
        }
        
        .logo {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .logo h1 {
            color: #333;
            font-size: 28px;
            margin-bottom: 10px;
        }
        
        .logo p {
            color: #666;
            font-size: 16px;
        }
        
        .tabs {
            display: flex;
            margin-bottom: 20px;
            background: #f1f1f1;
            border-radius: 10px;
            padding: 5px;
        }
        
        .tab {
            flex: 1;
            text-align: center;
            padding: 10px;
            cursor: pointer;
            border-radius: 8px;
            transition: 0.3s;
        }
        
        .tab.active {
            background: white;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .content {
            display: none;
        }
        
        .content.active {
            display: block;
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 500;
        }
        
        input {
            width: 100%;
            padding: 15px;
            border: 2px solid #e1e1e1;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
        }
        
        input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }
        
        .admin-link {
            text-align: center;
            margin-top: 20px;
        }
        
        .admin-link a {
            color: #667eea;
            text-decoration: none;
            font-size: 14px;
        }
        
        .message {
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 15px;
            text-align: center;
            display: none;
        }
        
        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="logo">
            <h1>ğŸ”’ My Vault</h1>
            <p>Ø®Ø²Ù†ØªÙƒ Ø§Ù„Ø¢Ù…Ù†Ø© Ø§Ù„Ø´Ø®ØµÙŠØ©</p>
        </div>
        
        <div id="message" class="message"></div>
        
        <div class="tabs">
            <div class="tab active" onclick="showTab('login')">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</div>
            <div class="tab" onclick="showTab('activate')">ØªÙØ¹ÙŠÙ„ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯</div>
        </div>

        <!-- Ù‚Ø³Ù… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ -->
<div id="login" class="content active">
    <div class="input-group">
        <label for="username">Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</label>
        <input type="text" id="username" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…">
    </div>
    
    <div class="input-group">
        <label for="password">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
        <input type="password" id="password" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
    </div>
    
    <button class="btn" onclick="loginUser()">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
</div>

<!-- Ù‚Ø³Ù… Ø§Ù„ØªÙØ¹ÙŠÙ„ -->
<div id="activate" class="content">
    <div class="input-group">
        <label for="activationCode">ÙƒÙˆØ¯ Ø§Ù„ØªÙØ¹ÙŠÙ„ (6 Ø£Ø±Ù‚Ø§Ù…)</label>
        <input 
            type="text" 
            id="activationCode" 
            placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù…ÙƒÙˆÙ† Ù…Ù† 6 Ø£Ø±Ù‚Ø§Ù…"
            maxlength="6"
            oninput="this.value = this.value.replace(/[^0-9]/g, '')"
        >
    </div>
    
    <button class="btn" onclick="showCreateAccount()">ØªÙØ¹ÙŠÙ„ ÙˆØ¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨</button>
    
    <!-- â­â­ Ø²Ø± Ø·Ù„Ø¨ ÙƒÙˆØ¯ Ø§Ù„ØªÙØ¹ÙŠÙ„ Ø¹Ø¨Ø± Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ â­â­ -->
    <div style="text-align: center; margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 10px; border: 1px solid #e1e8ed;">
        <p style="margin-bottom: 10px; color: #666; font-size: 14px;">Ù„Ø§ ØªÙ…Ù„Ùƒ ÙƒÙˆØ¯ ØªÙØ¹ÙŠÙ„ØŸ</p>
        <button class="btn" onclick="requestActivationCode()" style="background: linear-gradient(135deg, #25D366, #128C7E); color: white; border: none;">
            ğŸ“² Ø·Ù„Ø¨ ÙƒÙˆØ¯ ØªÙØ¹ÙŠÙ„ Ø¹Ø¨Ø± Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨
        </button>
    </div>
</div>

<!-- Ù‚Ø³Ù… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨ -->
<div id="createAccount" class="content">
    <div class="input-group">
        <label for="newUsername">Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯</label>
        <input type="text" id="newUsername" placeholder="Ø§Ø®ØªØ± Ø§Ø³Ù… Ù…Ø³ØªØ®Ø¯Ù…">
    </div>
    
    <div class="input-group">
        <label for="newPassword">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©</label>
        <input type="password" id="newPassword" placeholder="Ø§Ø®ØªØ± ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ù‚ÙˆÙŠØ©">
    </div>
    
    <div class="input-group">
        <label for="confirmPassword">ØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
        <input type="password" id="confirmPassword" placeholder="Ø£Ø¹Ø¯ ÙƒØªØ§Ø¨Ø© ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
    </div>
    
    <button class="btn" onclick="createUserAccount()">Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨</button>
</div>
        
        <!-- â­â­ Ø£Ø¶Ù Ù‡Ø°Ø§ Ø§Ù„ÙƒÙˆØ¯ Ù‡Ù†Ø§ â­â­ -->
        <div class="admin-link">
            <button onclick="openAdmin()" style="
                background: none;
                border: none;
                color: #667eea;
                cursor: pointer;
                font-size: 14px;
                text-decoration: underline;
                padding: 0;
                margin-top: 15px;
            ">Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙƒÙ…Ø³Ø¤ÙˆÙ„</button>
        </div>
        <!-- â­â­ Ù†Ù‡Ø§ÙŠØ© Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù…Ø¶Ø§Ù â­â­ -->
    </div>

    <script>
    function openAdmin() {
        window.location.href = 'admin.html';
    }
    </script>
       

    <script>
    // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ
    function initializeStorage() {
        if (!localStorage.getItem('adminPassword')) {
    localStorage.setItem('adminPassword', 123123);
}
        }
        if (!localStorage.getItem('activationCodes')) {
            localStorage.setItem('activationCodes', JSON.stringify([]));
        }
        if (!localStorage.getItem('users')) {
            localStorage.setItem('users', JSON.stringify([]));
        }
    

    function showMessage(text, type) {
        const messageDiv = document.getElementById('message');
        messageDiv.textContent = text;
        messageDiv.className = `message ${type}`;
        messageDiv.style.display = 'block';
        
        setTimeout(() => {
            messageDiv.style.display = 'none';
        }, 5000);
    }

    function showTab(tabName) {
        document.querySelectorAll('.content').forEach(content => {
            content.classList.remove('active');
        });
        document.querySelectorAll('.tab').forEach(tab => {
            tab.classList.remove('active');
        });
        
        document.getElementById(tabName).classList.add('active');
        event.target.classList.add('active');
    }

    // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
    function loginUser() {
        const username = document.getElementById('username').value;
        const password = document.getElementById('password').value;
        
        if (!username || !password) {
            showMessage('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„', 'error');
            return;
        }
        
        const users = JSON.parse(localStorage.getItem('users') || '[]');
        const user = users.find(u => u.username === username && u.password === password);
        
        if (user) {
            // Ø­ÙØ¸ ÙÙŠ sessionStorage ÙÙ‚Ø·
            sessionStorage.setItem('currentUser', user.id);
            
            showMessage('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­!', 'success');
            
            setTimeout(() => {
                window.location.href = 'user.html';
            }, 2000);
        } else {
            showMessage('Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©', 'error');
        }
    }

    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ÙƒÙˆØ¯ ÙˆØ¹Ø±Ø¶ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨
    function showCreateAccount() {
        const code = document.getElementById('activationCode').value;
        
        if (code.length !== 6) {
            showMessage('Ø§Ù„ÙƒÙˆØ¯ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† 6 Ø£Ø±Ù‚Ø§Ù…', 'error');
            return;
        }
        
        const activationCodes = JSON.parse(localStorage.getItem('activationCodes') || '[]');
        const codeIndex = activationCodes.findIndex(c => c.code === code && c.used === false);
        
        if (codeIndex === -1) {
            showMessage('ÙƒÙˆØ¯ Ø§Ù„ØªÙØ¹ÙŠÙ„ ØºÙŠØ± ØµØ­ÙŠØ­ Ø£Ùˆ Ù…Ø³ØªØ®Ø¯Ù… Ù…Ù† Ù‚Ø¨Ù„', 'error');
            return;
        }
        
        // Ø­ÙØ¸ Ø§Ù„ÙƒÙˆØ¯ Ù…Ø¤Ù‚ØªØ§Ù‹ Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡ Ù„Ø§Ø­Ù‚Ø§Ù‹
        sessionStorage.setItem('tempActivationCode', code);
        showTab('createAccount');
    }

    // Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
function createUserAccount() {
    const username = document.getElementById('newUsername').value;
    const password = document.getElementById('newPassword').value;
    const confirmPassword = document.getElementById('confirmPassword').value;
    const activationCode = sessionStorage.getItem('tempActivationCode');
    
    if (!username || !password || !confirmPassword) {
        showMessage('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„', 'error');
        return;
    }
    
    if (password !== confirmPassword) {
        showMessage('ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± Ù…ØªØ·Ø§Ø¨Ù‚Ø©', 'error');
        return;
    }
    
    if (password.length < 6) {
        showMessage('ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† 6 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„', 'error');
        return;
    }
    
    const users = JSON.parse(localStorage.getItem('users') || '[]');
    
    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ Ø§Ø³Ù… Ù…Ø³ØªØ®Ø¯Ù… Ù…ÙƒØ±Ø±
    if (users.find(u => u.username === username)) {
        showMessage('Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…ÙˆØ¬ÙˆØ¯ Ù…Ø³Ø¨Ù‚Ø§Ù‹', 'error');
        return;
    }
    
    // ØªÙØ¹ÙŠÙ„ Ø§Ù„ÙƒÙˆØ¯
    const activationCodes = JSON.parse(localStorage.getItem('activationCodes') || '[]');
    const codeIndex = activationCodes.findIndex(c => c.code === activationCode);
    
    if (codeIndex !== -1) {
        activationCodes[codeIndex].used = true;
        activationCodes[codeIndex].usedAt = new Date().toISOString();
        activationCodes[codeIndex].usedBy = username;
        localStorage.setItem('activationCodes', JSON.stringify(activationCodes));
    }
    
    // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯
    const newUser = {
        id: Date.now().toString(),
        username: username,
        password: password,
        activationCode: activationCode,
        createdAt: new Date().toISOString(),
        data: {
            passwords: [],
            notes: [],
            images: [],
            documents: []
        }
    };
    
    users.push(newUser);
    localStorage.setItem('users', JSON.stringify(users));
    
    // Ø­ÙØ¸ ÙÙŠ sessionStorage ÙÙ‚Ø·
    sessionStorage.setItem('currentUser', newUser.id);
    
    // â­â­ Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø¹ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ø£Ø®Ø±Ù‰ â­â­
    shareDataWithOtherDevices();
    
    showMessage('ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø¨Ù†Ø¬Ø§Ø­!', 'success');
    
    setTimeout(() => {
        window.location.href = 'user.html';
    }, 2000);
}

// â­â­ Ù†Ø¸Ø§Ù… Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨ÙŠÙ† Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© â­â­
function shareDataWithOtherDevices() {
    try {
        const appData = {
            users: JSON.parse(localStorage.getItem('users') || '[]'),
            activationCodes: JSON.parse(localStorage.getItem('activationCodes') || '[]'),
            adminPassword: localStorage.getItem('adminPassword'),
            lastSync: new Date().toISOString()
        };
        
        // Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ù…Ù„Ù Ù‚Ø§Ø¨Ù„ Ù„Ù„Ù…Ø´Ø§Ø±ÙƒØ©
        const dataStr = JSON.stringify(appData, null, 2);
        const blob = new Blob([dataStr], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        
        // Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø§Ø¨Ø· Ù„Ù„Ù…Ø´Ø§Ø±ÙƒØ©
        const shareLink = `${window.location.origin}${window.location.pathname}?import=data`;
        console.log('ğŸ”— Ø±Ø§Ø¨Ø· Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', shareLink);
        
        // Ø­ÙØ¸ Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©
        localStorage.setItem('shareableLink', shareLink);
        localStorage.setItem('lastExport', new Date().toISOString());
        
    } catch (error) {
        console.log('âŒ Ø®Ø·Ø£ ÙÙŠ Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
    }
}

// â­â­ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø¬Ù‡Ø§Ø² Ø¢Ø®Ø± â­â­
function importDataFromOtherDevice() {
    const importData = prompt('ğŸ¯ Ø£Ø¯Ø®Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ù…Ù† Ø¬Ù‡Ø§Ø² Ø¢Ø®Ø± (JSON):');
    
    if (importData) {
        try {
            const appData = JSON.parse(importData);
            
            // Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
            if (appData.users && Array.isArray(appData.users)) {
                const existingUsers = JSON.parse(localStorage.getItem('users') || '[]');
                const mergedUsers = [...existingUsers, ...appData.users];
                
                // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØªÙƒØ±Ø§Ø±Ø§Øª
                const uniqueUsers = mergedUsers.filter((user, index, self) =>
                    index === self.findIndex(u => u.username === user.username)
                );
                
                localStorage.setItem('users', JSON.stringify(uniqueUsers));
            }
            
            // Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„ØªÙØ¹ÙŠÙ„
            if (appData.activationCodes && Array.isArray(appData.activationCodes)) {
                const existingCodes = JSON.parse(localStorage.getItem('activationCodes') || '[]');
                const mergedCodes = [...existingCodes, ...appData.activationCodes];
                
                // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØªÙƒØ±Ø§Ø±Ø§Øª
                const uniqueCodes = mergedCodes.filter((code, index, self) =>
                    index === self.findIndex(c => c.code === code.code)
                );
                
                localStorage.setItem('activationCodes', JSON.stringify(uniqueCodes));
            }
            
            // Ø§Ø³ØªÙŠØ±Ø§Ø¯ ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø§Ù„Ø£Ø¯Ù…Ù†
            if (appData.adminPassword) {
                localStorage.setItem('adminPassword', appData.adminPassword);
            }
            
            showMessage('âœ… ØªÙ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­!', 'success');
            setTimeout(() => location.reload(), 2000);
            
        } catch (error) {
            showMessage('âŒ Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± ØµØ§Ù„Ø­Ø©', 'error');
        }
    }
}

// â­â­ ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ù…Ø´Ø§Ø±ÙƒØ© â­â­
function exportDataForSharing() {
    try {
        const appData = {
            users: JSON.parse(localStorage.getItem('users') || '[]'),
            activationCodes: JSON.parse(localStorage.getItem('activationCodes') || '[]'),
            adminPassword: localStorage.getItem('adminPassword'),
            exportDate: new Date().toISOString(),
            version: localStorage.getItem('appVersion') || '1.0.0'
        };
        
        const dataStr = JSON.stringify(appData, null, 2);
        
        // Ù†Ø³Ø® Ù„Ù„ clipboard
        navigator.clipboard.writeText(dataStr).then(() => {
            showMessage('âœ… ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª - Ø§Ù„ØµÙ‚Ù‡Ø§ ÙÙŠ Ø§Ù„Ø¬Ù‡Ø§Ø² Ø§Ù„Ø¢Ø®Ø±', 'success');
        }).catch(() => {
            // Ø¥Ø°Ø§ clipboard Ù…Ø´ Ù…Ø¯Ø¹ÙˆÙ…ØŒ Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ prompt
            prompt('ğŸ“‹ Ø§Ù†Ø³Ø® Ù‡Ø°Ù‡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ§Ù„ØµÙ‚Ù‡Ø§ ÙÙŠ Ø§Ù„Ø¬Ù‡Ø§Ø² Ø§Ù„Ø¢Ø®Ø±:', dataStr);
        });
        
    } catch (error) {
        showMessage('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', 'error');
    }
}

// â­â­ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯ ÙÙŠ Ø§Ù„Ø±Ø§Ø¨Ø· â­â­
function checkForImportData() {
    const urlParams = new URLSearchParams(window.location.search);
    if (urlParams.get('import') === 'data') {
        setTimeout(() => {
            if (confirm('ğŸ¯ Ù‡Ù„ ØªØ±ÙŠØ¯ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ØŸ')) {
                exportDataForSharing();
            }
        }, 1000);
    }
}

// â­â­ Ø¥Ø¶Ø§ÙØ© Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© ÙÙŠ ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø£Ø¯Ù…Ù† â­â­
function addSharingButtons() {
    // ÙÙŠ ØµÙØ­Ø© Ø§Ù„Ø£Ø¯Ù…Ù†ØŒ Ø£Ø¶Ù Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©
    const sharingHTML = `
        <div style="margin: 20px 0; padding: 15px; background: #f8f9fa; border-radius: 10px;">
            <h4>ğŸ”„ Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</h4>
            <button onclick="exportDataForSharing()" class="btn" style="background: #28a745; margin: 5px;">
                ğŸ“¤ ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            </button>
            <button onclick="importDataFromOtherDevice()" class="btn" style="background: #17a2b8; margin: 5px;">
                ğŸ“¥ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            </button>
            <p style="font-size: 12px; color: #666; margin-top: 10px;">
                Ø§Ø³ØªØ®Ø¯Ù… Ù‡Ø°Ù‡ Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ù„Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ù…Ø¹ Ø£Ø¬Ù‡Ø²Ø© Ø£Ø®Ø±Ù‰
            </p>
        </div>
    `;
    
    // Ø¥Ø¶Ø§ÙØ© ÙÙŠ ØµÙØ­Ø© Ø§Ù„Ø£Ø¯Ù…Ù† Ø¥Ø°Ø§ Ù…ÙˆØ¬ÙˆØ¯Ø©
    const adminPanel = document.getElementById('adminPanel');
    if (adminPanel) {
        adminPanel.insertAdjacentHTML('beforeend', sharingHTML);
    }
}

// Ø§Ù„ØªØ­Ù‚Ù‚ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¬Ù„ Ø¨Ø§Ù„ÙØ¹Ù„
function checkExistingLogin() {
    const currentUser = sessionStorage.getItem('currentUser');
    if (currentUser) {
        window.location.href = 'user.html';
    }
}

// ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
initializeStorage();
checkExistingLogin();
checkForImportData();

// Ø¥Ø¶Ø§ÙØ© Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
setTimeout(addSharingButtons, 1000);
</script>
<script>
// Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
 class AutoUpdater {
    constructor() {
        this.updateUrl = 'https://shreifquraish.github.io/MyVault-App/version.json';
        // â­â­ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠ - Ø¨ÙŠØ¬ÙŠØ¨ Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ù…Ù† Ø§Ù„ØªØ®Ø²ÙŠÙ† â­â­
        this.currentVersion = localStorage.getItem('appVersion') || '1.0.0';
    }

    // â­â­ Ø¯Ø§Ù„Ø© Ø§Ù„ÙØ­Øµ Ø§Ù„ØµØ§Ù…Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© â­â­
    async silentCheck() {
        try {
            const response = await fetch(this.updateUrl);
            const data = await response.json();
            
            // â­â­ ØªØ­Ø¯ÙŠØ« currentVersion Ù…Ù† Ø§Ù„ØªØ®Ø²ÙŠÙ† â­â­
            this.currentVersion = localStorage.getItem('appVersion') || '1.0.0';
            
            if (data.version !== this.currentVersion) {
                this.showUpdateNotification(data);
            }
        } catch (error) {
            // Ù…ÙŠØ¸Ù‡Ø±Ø´ Ø­Ø§Ø¬Ø©
        }
    }

    async checkForUpdates() {
        // â­â­ ØªØ­Ø¯ÙŠØ« currentVersion Ø£ÙˆÙ„Ø§Ù‹ â­â­
        this.currentVersion = localStorage.getItem('appVersion') || '1.0.0';
        
        this.showMessage('ğŸ” Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª...', 'info');
        
        try {
            const response = await fetch(this.updateUrl);
            const data = await response.json();
            
            this.showMessage(`Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ø­Ø§Ù„ÙŠ: ${this.currentVersion}, Ø§Ù„Ø¬Ø¯ÙŠØ¯: ${data.version}`, 'info');
            
            if (data.version !== this.currentVersion) {
                this.showUpdateNotification(data);
            } else {
                this.showMessage('âœ… Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ù…Ø­Ø¯Ø«', 'success');
            }
        } catch (error) {
            this.showMessage('âŒ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…', 'error');
        }
    }

    // Ø¯Ø§Ù„Ø© Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…
    showMessage(text, type) {
        // Ø£Ù†Ø´Ø¦ Ø¹Ù†ØµØ± Ø±Ø³Ø§Ù„Ø© Ù…Ø¤Ù‚Øª
        const messageDiv = document.createElement('div');
        messageDiv.style.cssText = `
            position: fixed; top: 20px; left: 50%; transform: translateX(-50%);
            background: ${type === 'error' ? '#f8d7da' : type === 'success' ? '#d4edda' : '#d1ecf1'};
            color: ${type === 'error' ? '#721c24' : type === 'success' ? '#155724' : '#0c5460'};
            padding: 15px; border-radius: 5px; z-index: 10000;
            border: 1px solid ${type === 'error' ? '#f5c6cb' : type === 'success' ? '#c3e6cb' : '#bee5eb'};
        `;
        messageDiv.textContent = text;
        document.body.appendChild(messageDiv);
        
        // Ø§Ø­Ø°Ù Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø¨Ø¹Ø¯ 5 Ø«ÙˆØ§Ù†ÙŠ
        setTimeout(() => {
            if (messageDiv.parentNode) {
                messageDiv.parentNode.removeChild(messageDiv);
            }
        }, 5000);
    }

    showUpdateNotification(updateInfo) {
        if (confirm(`ğŸ”„ ÙŠÙˆØ¬Ø¯ ØªØ­Ø¯ÙŠØ« Ø¬Ø¯ÙŠØ¯ (${updateInfo.version})\n\n${updateInfo.changes}\n\nÙ‡Ù„ ØªØ±ÙŠØ¯ Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¢Ù†ØŸ`)) {
            this.applyUpdate(updateInfo.version); // â­â­ Ù†Ù…Ø±Ø± Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ø¬Ø¯ÙŠØ¯ â­â­
        }
    }

    async applyUpdate(newVersion) {
        this.showMessage('â­ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¢Ù…Ù†...', 'info');
        try {
            // Ø§Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ù‚Ø¨Ù„ Ø§Ù„ØªØ­Ø¯ÙŠØ«
            const currentUsers = localStorage.getItem('users');
            const currentCodes = localStorage.getItem('activationCodes');
            const currentAdminPass = localStorage.getItem('adminPassword');
            
            // Ø­Ù…Ù„ Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø­Ø¯Ø«Ø©
            await this.updateFile('user.html');
            await this.updateFile('admin.html');
            
            // â­â­ Ø­ÙØ¸ Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ â­â­
            localStorage.setItem('appVersion', newVersion);
            
            this.showMessage('âœ… ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¢Ù…Ù†!', 'success');
            setTimeout(() => location.reload(), 2000);
        } catch (error) {
            this.showMessage('âŒ ÙØ´Ù„ Ø§Ù„ØªØ­Ø¯ÙŠØ«', 'error');
        }
    }

    async updateFile(filename) {
        const response = await fetch(`https://shreifquraish.github.io/myapp//${filename}?v=${Date.now()}`);
        const content = await response.text();
        localStorage.setItem(`file_${filename}`, content);
    }
}

document.addEventListener('DOMContentLoaded', function() {
    const updater = new AutoUpdater();
    
    // â­â­ ØªØ­Ù‚Ù‚ ØµØ§Ù…Øª Ø¨Ø¹Ø¯ 3 Ø«ÙˆØ§Ù†ÙŠ - Ù…ÙŠØ¸Ù‡Ø±Ø´ Ø±Ø³Ø§Ø¦Ù„ â­â­
    setTimeout(() => updater.silentCheck(), 3000);
    
    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø­Ø¯Ø«Ø© Ù…Ù† Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ
    loadUpdatedFiles();
});

function loadUpdatedFiles() {
    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ø­Ø§Ù„ÙŠ Ù…Ù† Ø§Ù„ØªØ®Ø²ÙŠÙ†
    const savedVersion = localStorage.getItem('appVersion');
    const currentPage = location.pathname.split('/').pop();
    
    // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ù…Ø®Ø²Ù†Ø© Ù…Ø­Ù„ÙŠØ§Ù‹ØŒ Ù†Ø³ØªØ®Ø¯Ù…Ù‡Ø§
    const savedContent = localStorage.getItem(`file_${currentPage}`);
    if (savedContent && currentPage !== 'index.html') {
        document.open();
        document.write(savedContent);
        document.close();
    }
}

</script>
<script>
function requestActivationCode() {
    const whatsappNumber = "+201003041351";
    const message = "Ø£Ø±ÙŠØ¯ ÙƒÙˆØ¯ ØªÙØ¹ÙŠÙ„";
    window.open(`https://wa.me/${whatsappNumber}?text=${encodeURIComponent(message)}`, '_blank');
    alert('ÙŠØªÙ… ÙØªØ­ Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨...');
}
</script>
<script src="script.js?v=3">
</script>
</body>
</html>